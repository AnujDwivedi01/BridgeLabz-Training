/*

Exercise 2: Transaction Management
Implement a banking system with:
• Transfer money between accounts (use transactions)
• Check balance
• Transaction history

*/

USE mysql_jdbc_practice;

CREATE TABLE accounts (
    account_id INT PRIMARY KEY,
    account_holder VARCHAR(100) NOT NULL,
    balance DECIMAL(12,2) NOT NULL CHECK (balance >= 0),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);



CREATE TABLE transactions (
    txn_id INT AUTO_INCREMENT PRIMARY KEY,
    from_account INT,
    to_account INT,
    amount DECIMAL(12,2),
    txn_type VARCHAR(30),
    txn_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO accounts (account_id, account_holder, balance)
VALUES
(101, 'Anuj', 50000),
(102, 'Rahul', 30000),
(103, 'Sneha', 70000);

1->  Transfer money between accounts (use transactions)

START TRANSACTION;


SELECT balance FROM accounts WHERE account_id = 101;


UPDATE accounts
SET balance = balance - 5000
WHERE account_id = 101 AND balance >= 5000;


UPDATE accounts
SET balance = balance + 5000
WHERE account_id = 102;


INSERT INTO transactions (from_account, to_account, amount, txn_type)
VALUES (101, 102, 5000, 'TRANSFER');

COMMIT;

2-> Check balance

SELECT account_id, account_holder, balance
FROM accounts
WHERE account_id = 101;

+------------+----------------+----------+
| account_id | account_holder | balance  |
+------------+----------------+----------+
|        101 | Anuj           | 45000.00 |
+------------+----------------+----------+

3->  Transaction history

select * from transactions;
+--------+--------------+------------+---------+----------+---------------------+
| txn_id | from_account | to_account | amount  | txn_type | txn_time            |
+--------+--------------+------------+---------+----------+---------------------+
|      1 |          101 |        102 | 5000.00 | TRANSFER | 2026-02-08 23:52:39 |
+--------+--------------+------------+---------+----------+---------------------+





